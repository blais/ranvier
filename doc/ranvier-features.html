<?xml version="1.0" encoding="iso-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="generator" content="Docutils 0.5: http://docutils.sourceforge.net/" />
<title>urlmaps: Mapping URLs in Web Applications</title>
<meta name="author" content="Martin Blais &lt;blais&#64;furius.ca&gt;" />
<meta name="date" content="2006-04-11" />
<link rel="stylesheet" href="../style.css" type="text/css" />
</head>
<body>

<div id="project-header">
  <a href="/"><img src="/home/furius-logo-w.png" id="logo"></a>
  <div id="project-home"><a href="..">Project Home</a></div>
</div>

<div class="document" id="urlmaps-mapping-urls-in-web-applications">
<h1 class="title">urlmaps: Mapping URLs in Web Applications</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Author:</th>
<td>Martin Blais &lt;<a class="reference" href="mailto:blais&#64;furius.ca">blais&#64;furius.ca</a>&gt;</td></tr>
<tr><th class="docinfo-name">Date:</th>
<td>2006-04-11</td></tr>
</tbody>
</table>
<div class="abstract topic">
<p class="topic-title first">Abstract</p>
<p>(Unfinished) Documentation on the Ranvier URL mapping system.</p>
</div>
<div class="contents topic">
<p class="topic-title first"><a id="contents" name="contents">Contents</a></p>
<ul class="auto-toc simple">
<li><a class="reference" href="#introduction" id="id2" name="id2">1&nbsp;&nbsp;&nbsp;Introduction</a></li>
<li><a class="reference" href="#mapping-forward" id="id3" name="id3">2&nbsp;&nbsp;&nbsp;Mapping Forward</a><ul class="auto-toc">
<li><a class="reference" href="#chain-of-responsibility" id="id4" name="id4">2.1&nbsp;&nbsp;&nbsp;Chain of Responsibility</a></li>
<li><a class="reference" href="#naming-of-resources" id="id5" name="id5">2.2&nbsp;&nbsp;&nbsp;Naming of Resources</a></li>
</ul>
</li>
<li><a class="reference" href="#mapping-backward" id="id6" name="id6">3&nbsp;&nbsp;&nbsp;Mapping Backward</a><ul class="auto-toc">
<li><a class="reference" href="#optimization-of-backmapping" id="id7" name="id7">3.1&nbsp;&nbsp;&nbsp;Optimization of BackMapping</a></li>
<li><a class="reference" href="#static-maps" id="id8" name="id8">3.2&nbsp;&nbsp;&nbsp;Static Maps</a></li>
<li><a class="reference" href="#unique-identifiers" id="id9" name="id9">3.3&nbsp;&nbsp;&nbsp;Unique Identifiers</a></li>
</ul>
</li>
<li><a class="reference" href="#listing-urls" id="id10" name="id10">4&nbsp;&nbsp;&nbsp;Listing URLs</a></li>
<li><a class="reference" href="#embedding-security" id="id11" name="id11">5&nbsp;&nbsp;&nbsp;Embedding Security</a></li>
<li><a class="reference" href="#internal-redirects" id="id12" name="id12">6&nbsp;&nbsp;&nbsp;Internal Redirects</a></li>
<li><a class="reference" href="#support-for-debugging" id="id13" name="id13">7&nbsp;&nbsp;&nbsp;Support for Debugging</a></li>
<li><a class="reference" href="#a-routes-like-interface" id="id14" name="id14">8&nbsp;&nbsp;&nbsp;A Routes-Like Interface</a></li>
<li><a class="reference" href="#other" id="id15" name="id15">9&nbsp;&nbsp;&nbsp;(Other)</a></li>
</ul>
</div>
<!-- 1  Introduction
2  Mapping Forward
  2.1  Chain of Responsibility
  2.2  Naming of Resources
3  Mapping Backward
  3.1  Optimization of BackMapping
  3.2  Static Maps
  3.3  Unique Identifiers
4  Listing URLs
5  Embedding Security
6  Internal Redirects
7  Support for Debugging
8  A Routes-Like Interface
9  (Other) -->
<div class="section">
<h1><a class="toc-backref" href="#id2" id="introduction" name="introduction">1&nbsp;&nbsp;&nbsp;Introduction</a></h1>
<p>Mapping URLs is an important component of building web applications.
&#8230;</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id3" id="mapping-forward" name="mapping-forward">2&nbsp;&nbsp;&nbsp;Mapping Forward</a></h1>
<p>We can view URLs are function calls into a running computer program, i.e:</p>
<pre class="literal-block">
http://mysite.com/accounts/get_balance?user=blais&amp;accno=643843
</pre>
<p>maps in a web application into a call to some function <tt class="docutils literal"><span class="pre">get_balance</span></tt> with two
parameters, <em>user</em> and <em>accno</em>:</p>
<pre class="literal-block">
def get_balance( user, accno ):
    ...
</pre>
<p>This view is similar to the event loop model of desktop applications, where the
idle event loop consists of a server waiting for requests.  (The difference is
that the web's event loop serves multiple users and therefore must maintain
per-user global state, this is what we call <em>session data</em>, and it is
implemented using cookies, that a user's browser serves back to the server).</p>
<p>In the preceding example, the parameters were obvious, they were embedded in the
query arguments.  However, any part of the URL can be an argument:</p>
<pre class="literal-block">
http://mysite.com/users/blais/acc/643843/get_balance/
</pre>
<p>This tends to produce nicer URLs and bends the user into conceptually organizing
the resources he makes available on his server in a hierarchy.  Query arguments
are best reserved for optional arguments.</p>
<p>Within this view, we can easily explain the concept of <a class="reference" href="http://en.wikipedia.org/wiki/Representational_State_Transfer">RESTfulness</a>: an
resource is said to comply to the principles of REST if it does not have
significant side-effects, i.e. if it does not rely on global state/variables as
input.</p>
<div class="section">
<h2><a class="toc-backref" href="#id4" id="chain-of-responsibility" name="chain-of-responsibility">2.1&nbsp;&nbsp;&nbsp;Chain of Responsibility</a></h2>
<p>(explain resource system)</p>
<p>One of the advantages in using a Chain of Responsibility pattern to implement
the controller search is that complete flexibility is available to the
programmer.  We have no need to define a complicated and necessarily limited
wildcard matching system.  The matching of URL components is entirely up to you,
i.e. you can look up information in a database, augment the context object that
is passed along the search, etc.  This is much more powerful (and simpler) than
a wildcard system.</p>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id5" id="naming-of-resources" name="naming-of-resources">2.2&nbsp;&nbsp;&nbsp;Naming of Resources</a></h2>
<p>The overwhelmingly general case for leaf resources/controllers is that they are
instantiated only once.  We thus take the opportunity to forego having the user
enter resource names for each of these.  Instead, we reuse the names of the
classes of the leaf controllers to enter them in the URL map.</p>
<p>For those few cases where controllers are reused and instantiated in many
places, we provide an optional keyword argument to let the user uniquely name
the instances for later referral.</p>
</div>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id6" id="mapping-backward" name="mapping-backward">3&nbsp;&nbsp;&nbsp;Mapping Backward</a></h1>
<p>One problem with web applications is that due to the nature of the web
application frameworks, they tend to be rather static and difficult to change.
URLs are cross-referenced from page templates and sometimes build
programmatically, and it can be tricky to move resources around.</p>
<p>A solution for this is to let the URL construction be taken care of by the
resource system itself, mapping from the leaf of the URL back to the root, thus
re-constructing the original resource.</p>
<p>We can identify individual resources by using unique strings (e.g. <tt class="docutils literal"><span class="pre">//balance</span></tt>
the user account balance page) and then asking a central URL mapping service to
create the URLs for us to insert in web pages.  This process must require all
the parameters of the function to call, in order to insert them in their
appropriate place.</p>
<p>A web application build this way can be completely rearranged without breaking.</p>
<p>However, this flexibility makes using templates impossible.</p>
<div class="section">
<h2><a class="toc-backref" href="#id7" id="optimization-of-backmapping" name="optimization-of-backmapping">3.1&nbsp;&nbsp;&nbsp;Optimization of BackMapping</a></h2>
<ul class="simple">
<li>Ask each resource whether it is<ul>
<li>Static</li>
<li>A fixed name (e.g. user)</li>
<li>Programmatic (cannot optimize)</li>
</ul>
</li>
</ul>
<p>FIXME todo</p>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id8" id="static-maps" name="static-maps">3.2&nbsp;&nbsp;&nbsp;Static Maps</a></h2>
<p>Since we already have a global registry of URL maps that we use to generate our
URLs, we also provide the ability to map names to static and possibly external
URLs.  This is similar to Routes&#8217; &#8220;static named routes&#8221; feature.</p>
</div>
<div class="section">
<h2><a class="toc-backref" href="#id9" id="unique-identifiers" name="unique-identifiers">3.3&nbsp;&nbsp;&nbsp;Unique Identifiers</a></h2>
<p>FIXME do this, talk about the automatic conversion from the class names and the
possibility to identify instances.</p>
<blockquote>
<ul class="simple">
<li>We need to automatically compute these names from the names of the
classes, and a class attribute can be used on the classes to override that
as well as it should be able to be specified as a keyword argument on the
base class.</li>
</ul>
</blockquote>
</div>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id10" id="listing-urls" name="listing-urls">4&nbsp;&nbsp;&nbsp;Listing URLs</a></h1>
<p>One nice feature of our system is that we like to be able to get an entire list
of the URLs served by the system.  This is extremely useful, because:</p>
<ol class="arabic simple">
<li>We visually appreciate the entire list of documents which are offered to the
public.  We need this, because during development it is possible that
temporary resources are installed for debugging and later on forgotten.</li>
<li>Our test programs can automatically fetch this list (from a special resource
only served in testing mode) and can rebuild a mapper from it, so that they
are entirely independent of the application URL layout.</li>
</ol>
<p>(#. Can inspect the various security credentials that each URL requires.)</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id11" id="embedding-security" name="embedding-security">5&nbsp;&nbsp;&nbsp;Embedding Security</a></h1>
<p>The URLs can be grouped so that they share security access privileges.  For
example, any URL beginning with <tt class="docutils literal"><span class="pre">/backstore</span></tt> could require administrative
privileges.</p>
<p>One way to do this</p>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id12" id="internal-redirects" name="internal-redirects">6&nbsp;&nbsp;&nbsp;Internal Redirects</a></h1>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id13" id="support-for-debugging" name="support-for-debugging">7&nbsp;&nbsp;&nbsp;Support for Debugging</a></h1>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id14" id="a-routes-like-interface" name="a-routes-like-interface">8&nbsp;&nbsp;&nbsp;A Routes-Like Interface</a></h1>
<p>FIXME answer what is &#8220;Routes&#8221;</p>
<ul class="simple">
<li>provide an interface that is similar to routes, but that automatically creates
all the required resources underneath</li>
</ul>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id15" id="other" name="other">9&nbsp;&nbsp;&nbsp;(Other)</a></h1>
<p>Idea: in our resources traversal, we could put the query args together with the
parameters in the URL itself&#8230; they are really conceptually the same&#8230;</p>
</div>
</div>
</body>
</html>
